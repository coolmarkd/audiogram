<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Audiogram</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone=no">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300,600&display=swap" rel="stylesheet" type="text/css">
    <link href="/css/base.css" rel="stylesheet" type="text/css">
    <link href="/css/editor.css" rel="stylesheet" type="text/css">
    <link href="/fonts/fonts.css" rel="stylesheet" type="text/css">
  </head>
  <body class="loading">
    <div class="container">
      <h1>Audiogram</h1>
      <div id="loading">
        <div id="loading-bars">
          <div class="r1"></div><div class="r2"></div><div class="r3"></div><div class="r4"></div><div class="r5"></div>
        </div>
        <div id="loading-message">Loading...</div>
      </div><!-- #loading -->
      <div id="loaded">
        <div id="error"></div>
        <div class="row form-row" id="row-audio">
          <label for="input-audio">Audio</label>
          <input id="input-audio" name="audio" type="file" />
        </div>
        <div class="row form-row" id="row-theme">
          <label for="input-theme">Theme</label>
          <select id="input-theme" name="theme"></select>
        </div>
        <div class="row form-row" id="row-caption-mode">
          <label for="caption-mode-static">Caption Mode</label>
          <div class="radio-group">
            <label class="radio-label">
              <input type="radio" id="caption-mode-static" name="captionMode" value="static" checked />
              <span>Static Caption</span>
            </label>
            <label class="radio-label">
              <input type="radio" id="caption-mode-auto" name="captionMode" value="auto" />
              <span>Auto-Generate (Transcribe)</span>
            </label>
          </div>
        </div>
        <div class="row form-row" id="row-caption">
          <label for="input-caption">
            Caption
            <div class="note">Add two spaces in a row to force a line break.</div>
          </label>
          <input id="input-caption" name="caption" type="text" autocomplete="off" placeholder="Add a caption" />
        </div>
        <div id="captions-editor" class="hidden">
          <div id="captions-header">
            <h3>Timed Captions</h3>
            <div id="transcription-options">
              <label class="checkbox-label">
                <input type="checkbox" id="enable-speaker-recognition" checked>
                <span class="checkmark"></span>
                Enable Speaker Recognition
              </label>
              <div class="note">Identify different speakers (Host, Guest, etc.)</div>
              
              <label class="checkbox-label">
                <input type="checkbox" id="enable-disfluencies">
                <span class="checkmark"></span>
                Transcribe Disfluencies
              </label>
              <div class="note">Include filler words like "umm", "uh", "you know" in transcription</div>
              
              <div id="speaker-count-options" class="speaker-count-section">
                <label for="speaker-count-type">Speaker Count Setting:</label>
                <select id="speaker-count-type">
                  <option value="auto">Auto-detect</option>
                  <option value="minimum">Minimum speakers</option>
                  <option value="exact">Exact speakers</option>
                </select>
                
                <div id="speaker-count-input" class="speaker-count-input hidden">
                  <label for="speaker-count-value">Number of speakers:</label>
                  <input type="number" id="speaker-count-value" min="1" max="10" value="2">
                  <div class="note" id="speaker-count-note">Set the minimum number of speakers to detect</div>
                </div>
              </div>
              
              <div id="keyterms-section" class="keyterms-section">
                <label for="keyterms-text">Keyterms for Better Accuracy:</label>
                <div class="note">Add domain-specific words or phrases (up to 1000 for Slam-1, 200 for Universal) to improve transcription accuracy. One term per line.</div>
                
                <div class="keyterms-controls">
                  <button type="button" id="keyterms-upload-btn" class="keyterms-btn">üìÅ Upload from File</button>
                  <button type="button" id="keyterms-export-btn" class="keyterms-btn">üíæ Export to File</button>
                  <button type="button" id="keyterms-clear-btn" class="keyterms-btn">üóëÔ∏è Clear All</button>
                  <input type="file" id="keyterms-file-input" accept=".txt" style="display: none;">
                </div>
                
                <textarea id="keyterms-text" placeholder="Enter keyterms here, one per line...&#10;Example:&#10;medical diagnosis&#10;hypertension&#10;Wellbutrin XL 150mg&#10;differential diagnosis"></textarea>
                <div class="keyterms-count">
                  <span id="keyterms-count">0</span> terms (max 1000 for Slam-1, 200 for Universal)
                </div>
              </div>
            </div>
            <button id="transcribe-btn" class="button">Generate Captions</button>
          </div>
          <div id="speaker-names-editor" class="hidden">
            <h4>Speaker Names</h4>
            <div id="speaker-names-list"></div>
          </div>
          <div id="caption-formatting-editor" class="hidden">
            <h4>Caption Formatting</h4>
            <div id="formatting-tabs">
              <button class="formatting-tab active" data-tab="global">Global</button>
              <button class="formatting-tab" data-tab="speakers">Per Speaker</button>
            </div>
            <div id="global-formatting" class="formatting-panel active">
              <div class="formatting-group">
                <label>Position</label>
                <div class="position-controls">
                  <div class="control-row">
                    <label>X Position:</label>
                    <input type="range" id="caption-x" min="0" max="100" value="50" step="1">
                    <span id="caption-x-value">50%</span>
                  </div>
                  <div class="control-row">
                    <label>Y Position:</label>
                    <input type="range" id="caption-y" min="0" max="100" value="85" step="1">
                    <span id="caption-y-value">85%</span>
                  </div>
                </div>
              </div>
              <div class="formatting-group">
                <label>Font</label>
                <div class="font-controls">
                  <div class="control-row">
                    <label>Size:</label>
                    <input type="range" id="caption-font-size" min="12" max="72" value="42" step="2">
                    <span id="caption-font-size-value">42px</span>
                  </div>
                  <div class="control-row">
                    <label>Color:</label>
                    <input type="color" id="caption-color" value="#ffffff">
                  </div>
                  <div class="control-row">
                    <label>Background:</label>
                    <input type="color" id="caption-bg-color" value="#000000">
                    <input type="range" id="caption-bg-opacity" min="0" max="100" value="70" step="5">
                    <span id="caption-bg-opacity-value">70%</span>
                  </div>
                  <div class="control-row">
                    <label>Text Stroke Color:</label>
                    <input type="color" id="caption-stroke-color" value="#000000">
                  </div>
                  <div class="control-row">
                    <label>Stroke Width:</label>
                    <input type="range" id="caption-stroke-width" min="0" max="10" value="2" step="1">
                    <span id="caption-stroke-width-value">2px</span>
                  </div>
                </div>
              </div>
            </div>
            <div id="speakers-formatting" class="formatting-panel">
              <div id="speaker-formatting-list"></div>
            </div>
          </div>
          <div id="waveform-positioning-editor" class="hidden">
            <h4>Waveform Configuration</h4>
            <div id="waveform-tabs">
              <button class="waveform-tab active" data-tab="position">Position</button>
              <button class="waveform-tab" data-tab="style">Style</button>
            </div>
            <div id="waveform-position" class="waveform-panel active">
              <div class="formatting-group">
                <div class="position-controls">
                  <div class="control-row">
                    <label>X Position:</label>
                    <input type="range" id="waveform-x" min="0" max="100" value="50" step="1">
                    <span id="waveform-x-value">50%</span>
                  </div>
                  <div class="control-row">
                    <label>Y Position:</label>
                    <input type="range" id="waveform-y" min="0" max="100" value="50" step="1">
                    <span id="waveform-y-value">50%</span>
                  </div>
                  <div class="control-row">
                    <label>Width:</label>
                    <input type="range" id="waveform-width" min="20" max="100" value="80" step="5">
                    <span id="waveform-width-value">80%</span>
                  </div>
                  <div class="control-row">
                    <label>Height:</label>
                    <input type="range" id="waveform-height" min="10" max="50" value="20" step="2">
                    <span id="waveform-height-value">20%</span>
                  </div>
                </div>
              </div>
            </div>
            <div id="waveform-style" class="waveform-panel">
              <div class="formatting-group">
                <label>Waveform Type</label>
                <div class="waveform-type-controls">
                  <div class="control-row">
                    <label>Style:</label>
                    <select id="waveform-type">
                      <option value="bars">Bars</option>
                      <option value="line">Line</option>
                      <option value="area">Area</option>
                      <option value="dots">Dots</option>
                      <option value="wave">Wave</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="formatting-group">
                <label>Colors</label>
                <div class="color-controls">
                  <div class="control-row">
                    <label>Primary Color:</label>
                    <input type="color" id="waveform-color" value="#ffffff">
                  </div>
                  <div class="control-row">
                    <label>Secondary Color:</label>
                    <input type="color" id="waveform-color-secondary" value="#cccccc">
                  </div>
                  <div class="control-row">
                    <label>Background:</label>
                    <input type="color" id="waveform-bg-color" value="#000000">
                    <input type="range" id="waveform-bg-opacity" min="0" max="100" value="0" step="5">
                    <span id="waveform-bg-opacity-value">0%</span>
                  </div>
                </div>
              </div>
              <div class="formatting-group">
                <label>Advanced</label>
                <div class="advanced-controls">
                  <div class="control-row">
                    <label>Bar Spacing:</label>
                    <input type="range" id="waveform-spacing" min="0" max="10" value="1" step="0.5">
                    <span id="waveform-spacing-value">1px</span>
                  </div>
                  <div class="control-row">
                    <label>Line Width:</label>
                    <input type="range" id="waveform-line-width" min="1" max="10" value="2" step="0.5">
                    <span id="waveform-line-width-value">2px</span>
                  </div>
                  <div class="control-row">
                    <label>Dot Size:</label>
                    <input type="range" id="waveform-dot-size" min="1" max="20" value="3" step="1">
                    <span id="waveform-dot-size-value">3px</span>
                  </div>
                  <div class="control-row">
                    <label>Smoothing:</label>
                    <input type="range" id="waveform-smoothing" min="0" max="100" value="0" step="5">
                    <span id="waveform-smoothing-value">0%</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div id="captions-list"></div>
        </div>
        <div id="caption-preview-section" class="hidden">
          <h4>Caption Preview</h4>
          <div id="caption-preview-container">
            <div id="caption-preview-canvas">
              <canvas width="640" height="360"></canvas>
              <div id="caption-preview-overlay">
                <div id="preview-caption" class="preview-caption"></div>
              </div>
            </div>
            <div id="preview-controls">
              <button id="preview-play" class="preview-btn">‚ñ∂ Play Preview</button>
              <button id="preview-pause" class="preview-btn hidden">‚è∏ Pause</button>
              <button id="preview-stop" class="preview-btn">‚èπ Stop</button>
              <span id="preview-time">0.0s</span>
            </div>
          </div>
        </div>
        <div id="preview">
          <div style="background-color: black;">
            <div id="canvas">
              <canvas width="640" height="360"></canvas>
              <div id="preview-label">Preview</div>
            </div>
          </div>
          <div id="minimap" class="hidden">
            <svg width="640" height="80" xmlns="http://www.w3.org/2000/svg">
              <defs>
                <clipPath id="clip">
                  <rect height="80" width="640" x="0" y="0"></rect>
                </clipPath>
              </defs>
              <g class="waveform background">
                <line x1="0" x2="640" y1="40" y2="40"></line>
                <path></path>
              </g>
              <g class="waveform foreground" clip-path="url(#clip)">
                <line x1="0" x2="640" y1="40" y2="40"></line>
                <path></path>
              </g>
              <g class="brush"></g>
              <g class="time">
                <line x1="0" x2="0" y1="0" y2="80"></line>
              </g>
            </svg>
            <div id="controls">
              <span id="tip">Click and drag over the waveform to clip audio<br />Use space bar to play/pause</span>
              <span id="duration"><strong></strong> seconds selected</span>
              <button id="play"><i class="fas fa-play"></i>Play</button>
              <button id="pause" class="hidden"><i class="fas fa-pause"></i>Pause</button>
              <button id="restart"><i class="fas fa-step-backward"></i>Restart</button>
            </div>
          </div>
        </div>
        <div id="audio">
          <audio controls>
            <source />
          </audio>
        </div>
        <div id="video">
          <video width="640" height="360" controls>
            <source type="video/mp4" />
          </video>
        </div>
        <div class="row" id="row-submit">
          <button type="button" id="return" class="left"><i class="fas fa-edit"></i>Return to editor</button>
          <button type="button" id="submit" class="right hidden"><i class="fas fa-cloud-upload"></i>Generate</button>
          <button type="button" id="regenerate" class="right hidden"><i class="fas fa-refresh"></i>Regenerate Video</button>
          <a id="download" class="button right" href="#" target="_blank"><i class="fas fa-download"></i>Download</a>
          <div class="clear"></div>
        </div>
      </div><!-- #loaded -->
    </div><!-- .container -->
    <script src="/js/bundle.js"></script>
    <!-- Force load custom fonts -->
    <script src="/fonts/fonts.js"></script>
  </body>
</html>
